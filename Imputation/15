Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=7, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=768, data='ETTm1', data_path='ETTm1.csv', dec_in=7, des='Exp', devices='0,1,2,3', distil=True, dropout=0.1, e_layers=2, embed='timeF', enc_in=7, factor=1, features='M', freq='h', gpt_layers=3, gpu=0, is_training=1, itr=3, label_len=0, learning_rate=0.001, ln=0, loss='MSE', lradj='type1', mask_rate=0.125, mlp=1, model='GPT4TS', model_id='ETTm1_mask_0.125', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patch_size=1, patience=3, percent=5, pred_len=0, root_path='/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/', seasonal_patterns='Monthly', seq_len=96, stride=1, target='OT', task_name='imputation', top_k=5, train_epochs=10, use_amp=False, use_gpu=True, use_multi_gpu=False, weight=0)
Use GPU: cuda:0
>>>>>>>start training : imputation_ETTm1_mask_0.125_GPT4TS_ETTm1_ftM_sl96_ll0_pl0_dm768_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2024-01-05 15:29:24,495 [37mDEBUG test: flag:train,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
train 1724
2024-01-05 15:29:24,540 [37mDEBUG test: flag:val,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
val 11521
2024-01-05 15:29:24,584 [37mDEBUG test: flag:test,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
test 11521
0it [00:00, ?it/s]1it [00:01,  1.22s/it]13it [00:01, 13.24it/s]24it [00:01, 25.67it/s]35it [00:01, 38.64it/s]46it [00:01, 51.13it/s]57it [00:01, 62.66it/s]68it [00:01, 72.65it/s]79it [00:01, 80.97it/s]90it [00:02, 87.73it/s]	iters: 100, epoch: 1 | loss: 0.0299993
	speed: 0.0238s/iter; left time: 23.0704s
101it [00:02, 92.87it/s]107it [00:02, 47.84it/s]
Epoch: 1 cost time: 2.471951961517334
0it [00:00, ?it/s]23it [00:00, 224.75it/s]52it [00:00, 255.72it/s]82it [00:00, 271.57it/s]112it [00:00, 279.20it/s]142it [00:00, 283.25it/s]172it [00:00, 285.92it/s]201it [00:00, 285.09it/s]231it [00:00, 287.25it/s]261it [00:00, 288.65it/s]291it [00:01, 289.31it/s]321it [00:01, 290.18it/s]351it [00:01, 290.59it/s]381it [00:01, 291.03it/s]411it [00:01, 290.95it/s]441it [00:01, 290.96it/s]471it [00:01, 291.32it/s]501it [00:01, 291.72it/s]531it [00:01, 291.71it/s]561it [00:01, 291.84it/s]591it [00:02, 291.65it/s]621it [00:02, 291.69it/s]651it [00:02, 291.50it/s]681it [00:02, 292.23it/s]711it [00:02, 292.81it/s]720it [00:02, 278.85it/s]
0it [00:00, ?it/s]19it [00:00, 187.53it/s]49it [00:00, 251.39it/s]79it [00:00, 270.45it/s]109it [00:00, 279.38it/s]139it [00:00, 284.11it/s]169it [00:00, 287.22it/s]199it [00:00, 289.88it/s]229it [00:00, 291.46it/s]259it [00:00, 292.50it/s]289it [00:01, 293.11it/s]319it [00:01, 293.40it/s]349it [00:01, 293.28it/s]379it [00:01, 293.53it/s]409it [00:01, 293.45it/s]439it [00:01, 293.32it/s]469it [00:01, 293.58it/s]499it [00:01, 293.75it/s]529it [00:01, 293.84it/s]559it [00:01, 294.11it/s]589it [00:02, 294.04it/s]619it [00:02, 293.97it/s]649it [00:02, 293.97it/s]679it [00:02, 293.56it/s]709it [00:02, 293.53it/s]720it [00:02, 281.32it/s]
Epoch: 1, Steps: 107 | Train Loss: 0.0346487 Vali Loss: 0.1985684 Test Loss: 0.1301115
Validation loss decreased (inf --> 0.198568).  Saving model ...
Updating learning rate to 0.001
0it [00:00, ?it/s]11it [00:00, 107.34it/s]22it [00:00, 107.47it/s]33it [00:00, 107.02it/s]44it [00:00, 106.85it/s]55it [00:00, 106.69it/s]66it [00:00, 106.43it/s]77it [00:00, 106.37it/s]88it [00:00, 106.43it/s]99it [00:00, 106.28it/s]	iters: 100, epoch: 2 | loss: 0.0188148
	speed: 0.0733s/iter; left time: 63.3393s
107it [00:01, 99.34it/s]
Epoch: 2 cost time: 1.3837082386016846
0it [00:00, ?it/s]23it [00:00, 228.27it/s]53it [00:00, 268.73it/s]83it [00:00, 280.51it/s]113it [00:00, 285.74it/s]143it [00:00, 289.00it/s]173it [00:00, 291.08it/s]203it [00:00, 292.55it/s]233it [00:00, 293.23it/s]263it [00:00, 293.22it/s]293it [00:01, 292.78it/s]323it [00:01, 292.52it/s]353it [00:01, 292.81it/s]383it [00:01, 292.93it/s]413it [00:01, 293.13it/s]443it [00:01, 292.12it/s]473it [00:01, 292.01it/s]503it [00:01, 291.88it/s]533it [00:01, 292.16it/s]563it [00:01, 292.67it/s]593it [00:02, 292.88it/s]623it [00:02, 292.99it/s]653it [00:02, 292.90it/s]683it [00:02, 293.15it/s]713it [00:02, 293.02it/s]720it [00:02, 285.07it/s]
0it [00:00, ?it/s]21it [00:00, 207.72it/s]51it [00:00, 260.21it/s]81it [00:00, 275.19it/s]111it [00:00, 281.30it/s]140it [00:00, 283.32it/s]169it [00:00, 285.28it/s]198it [00:00, 286.62it/s]227it [00:00, 287.23it/s]257it [00:00, 289.01it/s]287it [00:01, 289.38it/s]317it [00:01, 290.82it/s]347it [00:01, 291.22it/s]377it [00:01, 291.97it/s]407it [00:01, 292.20it/s]437it [00:01, 292.39it/s]467it [00:01, 292.89it/s]497it [00:01, 293.47it/s]527it [00:01, 293.87it/s]557it [00:01, 295.11it/s]587it [00:02, 296.51it/s]617it [00:02, 297.40it/s]647it [00:02, 298.09it/s]677it [00:02, 298.10it/s]708it [00:02, 299.01it/s]720it [00:02, 285.13it/s]
Epoch: 2, Steps: 107 | Train Loss: 0.0241844 Vali Loss: 0.1585031 Test Loss: 0.1075016
Validation loss decreased (0.198568 --> 0.158503).  Saving model ...
Updating learning rate to 0.0005
0it [00:00, ?it/s]11it [00:00, 108.08it/s]22it [00:00, 106.86it/s]33it [00:00, 106.48it/s]44it [00:00, 106.41it/s]55it [00:00, 106.32it/s]66it [00:00, 106.28it/s]77it [00:00, 106.21it/s]88it [00:00, 106.29it/s]99it [00:00, 106.32it/s]	iters: 100, epoch: 3 | loss: 0.0216094
	speed: 0.0727s/iter; left time: 55.0464s
107it [00:01, 101.71it/s]
Epoch: 3 cost time: 1.3572847843170166
0it [00:00, ?it/s]26it [00:00, 259.92it/s]56it [00:00, 279.48it/s]86it [00:00, 286.30it/s]116it [00:00, 289.49it/s]146it [00:00, 291.00it/s]176it [00:00, 292.18it/s]206it [00:00, 292.58it/s]236it [00:00, 292.99it/s]266it [00:00, 293.06it/s]296it [00:01, 293.74it/s]326it [00:01, 294.60it/s]356it [00:01, 295.39it/s]386it [00:01, 295.91it/s]416it [00:01, 296.02it/s]446it [00:01, 296.59it/s]476it [00:01, 296.89it/s]506it [00:01, 297.38it/s]536it [00:01, 297.44it/s]566it [00:01, 297.23it/s]596it [00:02, 297.70it/s]626it [00:02, 297.73it/s]656it [00:02, 297.74it/s]686it [00:02, 297.65it/s]716it [00:02, 297.75it/s]720it [00:02, 289.08it/s]
0it [00:00, ?it/s]29it [00:00, 281.64it/s]58it [00:00, 285.97it/s]88it [00:00, 288.89it/s]118it [00:00, 290.64it/s]148it [00:00, 291.43it/s]178it [00:00, 291.69it/s]208it [00:00, 291.90it/s]238it [00:00, 292.09it/s]268it [00:00, 291.99it/s]298it [00:01, 292.32it/s]328it [00:01, 292.76it/s]358it [00:01, 292.71it/s]388it [00:01, 292.76it/s]418it [00:01, 293.58it/s]448it [00:01, 294.00it/s]478it [00:01, 294.45it/s]508it [00:01, 295.03it/s]538it [00:01, 295.77it/s]568it [00:01, 296.64it/s]598it [00:02, 296.36it/s]628it [00:02, 296.64it/s]658it [00:02, 296.96it/s]688it [00:02, 297.37it/s]718it [00:02, 297.98it/s]720it [00:02, 288.59it/s]
Epoch: 3, Steps: 107 | Train Loss: 0.0220456 Vali Loss: 0.1568104 Test Loss: 0.1042068
Validation loss decreased (0.158503 --> 0.156810).  Saving model ...
Updating learning rate to 0.00025
0it [00:00, ?it/s]11it [00:00, 107.98it/s]22it [00:00, 107.19it/s]33it [00:00, 106.89it/s]44it [00:00, 106.59it/s]55it [00:00, 106.50it/s]66it [00:00, 106.32it/s]77it [00:00, 106.34it/s]88it [00:00, 106.33it/s]99it [00:00, 106.37it/s]	iters: 100, epoch: 4 | loss: 0.0212123
	speed: 0.0719s/iter; left time: 46.7263s
107it [00:01, 100.74it/s]
Epoch: 4 cost time: 1.3705883026123047
0it [00:00, ?it/s]28it [00:00, 277.97it/s]58it [00:00, 288.85it/s]88it [00:00, 291.80it/s]118it [00:00, 293.32it/s]148it [00:00, 294.33it/s]178it [00:00, 295.26it/s]208it [00:00, 294.99it/s]238it [00:00, 295.62it/s]268it [00:00, 296.19it/s]298it [00:01, 297.23it/s]328it [00:01, 297.01it/s]358it [00:01, 297.43it/s]388it [00:01, 297.28it/s]418it [00:01, 296.89it/s]448it [00:01, 296.52it/s]478it [00:01, 296.35it/s]508it [00:01, 296.05it/s]538it [00:01, 295.55it/s]568it [00:01, 296.35it/s]598it [00:02, 296.64it/s]628it [00:02, 296.47it/s]658it [00:02, 297.15it/s]688it [00:02, 297.37it/s]718it [00:02, 296.71it/s]720it [00:02, 290.38it/s]
0it [00:00, ?it/s]29it [00:00, 286.41it/s]59it [00:00, 292.43it/s]89it [00:00, 293.86it/s]119it [00:00, 294.57it/s]149it [00:00, 293.47it/s]179it [00:00, 294.00it/s]209it [00:00, 294.55it/s]239it [00:00, 294.43it/s]269it [00:00, 295.00it/s]299it [00:01, 295.08it/s]329it [00:01, 294.78it/s]359it [00:01, 294.51it/s]389it [00:01, 294.50it/s]419it [00:01, 294.40it/s]449it [00:01, 294.06it/s]479it [00:01, 294.58it/s]509it [00:01, 294.55it/s]539it [00:01, 294.60it/s]569it [00:01, 294.71it/s]599it [00:02, 294.56it/s]629it [00:02, 294.64it/s]659it [00:02, 294.76it/s]689it [00:02, 294.93it/s]719it [00:02, 295.87it/s]720it [00:02, 289.09it/s]
Epoch: 4, Steps: 107 | Train Loss: 0.0206612 Vali Loss: 0.1639844 Test Loss: 0.1104620
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
0it [00:00, ?it/s]11it [00:00, 106.47it/s]22it [00:00, 106.62it/s]33it [00:00, 106.58it/s]44it [00:00, 106.51it/s]55it [00:00, 106.41it/s]66it [00:00, 106.43it/s]77it [00:00, 106.31it/s]88it [00:00, 106.29it/s]99it [00:00, 106.29it/s]	iters: 100, epoch: 5 | loss: 0.0263904
	speed: 0.0696s/iter; left time: 37.8181s
107it [00:01, 101.57it/s]
Epoch: 5 cost time: 1.362889289855957
0it [00:00, ?it/s]22it [00:00, 216.64it/s]52it [00:00, 263.90it/s]82it [00:00, 278.91it/s]112it [00:00, 286.17it/s]142it [00:00, 290.71it/s]173it [00:00, 294.03it/s]203it [00:00, 295.67it/s]234it [00:00, 297.29it/s]264it [00:00, 297.95it/s]294it [00:01, 297.90it/s]324it [00:01, 298.28it/s]355it [00:01, 298.75it/s]385it [00:01, 298.81it/s]416it [00:01, 299.37it/s]446it [00:01, 299.18it/s]476it [00:01, 297.74it/s]506it [00:01, 297.34it/s]536it [00:01, 297.27it/s]566it [00:01, 297.52it/s]596it [00:02, 297.51it/s]626it [00:02, 297.75it/s]656it [00:02, 298.06it/s]686it [00:02, 297.57it/s]716it [00:02, 297.46it/s]720it [00:02, 289.21it/s]
0it [00:00, ?it/s]23it [00:00, 227.19it/s]53it [00:00, 265.94it/s]83it [00:00, 277.52it/s]113it [00:00, 283.27it/s]143it [00:00, 286.77it/s]173it [00:00, 288.95it/s]203it [00:00, 290.58it/s]233it [00:00, 291.66it/s]263it [00:00, 291.73it/s]293it [00:01, 291.41it/s]323it [00:01, 292.33it/s]353it [00:01, 293.37it/s]383it [00:01, 293.71it/s]413it [00:01, 293.67it/s]443it [00:01, 294.19it/s]473it [00:01, 294.80it/s]503it [00:01, 296.20it/s]533it [00:01, 297.11it/s]563it [00:01, 297.65it/s]593it [00:02, 298.26it/s]623it [00:02, 298.72it/s]653it [00:02, 298.47it/s]683it [00:02, 298.40it/s]713it [00:02, 298.75it/s]720it [00:02, 287.10it/s]
Epoch: 5, Steps: 107 | Train Loss: 0.0205063 Vali Loss: 0.1548042 Test Loss: 0.1037207
Validation loss decreased (0.156810 --> 0.154804).  Saving model ...
Updating learning rate to 6.25e-05
0it [00:00, ?it/s]11it [00:00, 105.53it/s]22it [00:00, 106.23it/s]33it [00:00, 106.34it/s]44it [00:00, 106.28it/s]55it [00:00, 106.35it/s]66it [00:00, 106.32it/s]77it [00:00, 106.29it/s]88it [00:00, 106.26it/s]99it [00:00, 106.21it/s]	iters: 100, epoch: 6 | loss: 0.0198976
	speed: 0.0722s/iter; left time: 31.4724s
107it [00:01, 101.50it/s]
Epoch: 6 cost time: 1.3633053302764893
0it [00:00, ?it/s]26it [00:00, 254.41it/s]56it [00:00, 276.59it/s]86it [00:00, 284.46it/s]116it [00:00, 288.64it/s]146it [00:00, 290.21it/s]176it [00:00, 291.83it/s]206it [00:00, 292.35it/s]236it [00:00, 292.61it/s]266it [00:00, 292.65it/s]296it [00:01, 292.31it/s]326it [00:01, 292.54it/s]356it [00:01, 292.78it/s]386it [00:01, 293.04it/s]416it [00:01, 293.68it/s]446it [00:01, 293.77it/s]476it [00:01, 293.94it/s]506it [00:01, 294.00it/s]536it [00:01, 293.82it/s]566it [00:01, 293.99it/s]596it [00:02, 293.94it/s]626it [00:02, 293.85it/s]656it [00:02, 294.26it/s]686it [00:02, 294.74it/s]716it [00:02, 295.10it/s]720it [00:02, 286.71it/s]
0it [00:00, ?it/s]17it [00:00, 167.24it/s]47it [00:00, 243.55it/s]77it [00:00, 267.84it/s]107it [00:00, 280.02it/s]137it [00:00, 287.17it/s]167it [00:00, 291.37it/s]197it [00:00, 293.85it/s]227it [00:00, 295.21it/s]257it [00:00, 296.11it/s]287it [00:01, 296.75it/s]317it [00:01, 296.78it/s]347it [00:01, 296.78it/s]377it [00:01, 297.26it/s]407it [00:01, 297.67it/s]437it [00:01, 298.22it/s]467it [00:01, 298.22it/s]497it [00:01, 298.65it/s]527it [00:01, 297.97it/s]557it [00:01, 297.55it/s]587it [00:02, 297.34it/s]617it [00:02, 297.06it/s]647it [00:02, 296.65it/s]677it [00:02, 295.87it/s]707it [00:02, 296.25it/s]720it [00:02, 286.93it/s]
Epoch: 6, Steps: 107 | Train Loss: 0.0198880 Vali Loss: 0.1510846 Test Loss: 0.1008920
Validation loss decreased (0.154804 --> 0.151085).  Saving model ...
Updating learning rate to 3.125e-05
0it [00:00, ?it/s]11it [00:00, 107.86it/s]22it [00:00, 106.79it/s]33it [00:00, 106.53it/s]44it [00:00, 106.38it/s]55it [00:00, 106.28it/s]66it [00:00, 106.25it/s]77it [00:00, 106.28it/s]88it [00:00, 106.30it/s]99it [00:00, 106.42it/s]	iters: 100, epoch: 7 | loss: 0.0187437
	speed: 0.0725s/iter; left time: 23.8525s
107it [00:01, 101.75it/s]
Epoch: 7 cost time: 1.3601951599121094
0it [00:00, ?it/s]27it [00:00, 263.86it/s]57it [00:00, 280.68it/s]87it [00:00, 287.37it/s]117it [00:00, 291.02it/s]147it [00:00, 292.84it/s]177it [00:00, 293.67it/s]207it [00:00, 294.49it/s]237it [00:00, 294.58it/s]267it [00:00, 294.92it/s]297it [00:01, 295.47it/s]327it [00:01, 295.73it/s]357it [00:01, 295.89it/s]387it [00:01, 296.39it/s]417it [00:01, 295.93it/s]447it [00:01, 296.03it/s]477it [00:01, 295.87it/s]507it [00:01, 295.69it/s]537it [00:01, 296.07it/s]567it [00:01, 296.30it/s]597it [00:02, 296.75it/s]627it [00:02, 296.72it/s]657it [00:02, 296.48it/s]687it [00:02, 296.41it/s]717it [00:02, 296.87it/s]720it [00:02, 288.29it/s]
0it [00:00, ?it/s]21it [00:00, 208.73it/s]51it [00:00, 260.26it/s]81it [00:00, 275.82it/s]111it [00:00, 284.07it/s]141it [00:00, 288.30it/s]171it [00:00, 290.57it/s]201it [00:00, 291.67it/s]231it [00:00, 292.77it/s]261it [00:00, 293.80it/s]291it [00:01, 293.34it/s]321it [00:01, 292.57it/s]351it [00:01, 292.88it/s]381it [00:01, 292.43it/s]411it [00:01, 292.34it/s]441it [00:01, 292.08it/s]471it [00:01, 293.05it/s]501it [00:01, 293.89it/s]531it [00:01, 293.56it/s]561it [00:01, 293.57it/s]591it [00:02, 293.46it/s]621it [00:02, 294.27it/s]651it [00:02, 295.29it/s]681it [00:02, 296.25it/s]711it [00:02, 297.33it/s]720it [00:02, 285.77it/s]
Epoch: 7, Steps: 107 | Train Loss: 0.0202032 Vali Loss: 0.1506570 Test Loss: 0.1001921
Validation loss decreased (0.151085 --> 0.150657).  Saving model ...
Updating learning rate to 1.5625e-05
0it [00:00, ?it/s]11it [00:00, 108.54it/s]22it [00:00, 108.08it/s]33it [00:00, 107.67it/s]44it [00:00, 107.48it/s]55it [00:00, 107.24it/s]66it [00:00, 107.08it/s]77it [00:00, 107.12it/s]88it [00:00, 107.10it/s]99it [00:00, 106.96it/s]	iters: 100, epoch: 8 | loss: 0.0204048
	speed: 0.0721s/iter; left time: 16.0134s
107it [00:01, 102.34it/s]
Epoch: 8 cost time: 1.3523542881011963
0it [00:00, ?it/s]21it [00:00, 204.56it/s]51it [00:00, 257.81it/s]81it [00:00, 274.87it/s]111it [00:00, 283.40it/s]141it [00:00, 288.72it/s]171it [00:00, 292.14it/s]201it [00:00, 294.46it/s]231it [00:00, 295.89it/s]261it [00:00, 296.58it/s]291it [00:01, 297.10it/s]321it [00:01, 297.63it/s]351it [00:01, 297.46it/s]381it [00:01, 297.11it/s]411it [00:01, 297.25it/s]441it [00:01, 297.02it/s]471it [00:01, 296.83it/s]501it [00:01, 296.42it/s]531it [00:01, 296.29it/s]561it [00:01, 295.91it/s]591it [00:02, 295.46it/s]621it [00:02, 295.05it/s]651it [00:02, 295.85it/s]681it [00:02, 296.23it/s]711it [00:02, 296.44it/s]720it [00:02, 287.59it/s]
0it [00:00, ?it/s]27it [00:00, 267.02it/s]56it [00:00, 279.31it/s]86it [00:00, 284.62it/s]116it [00:00, 287.57it/s]146it [00:00, 289.40it/s]176it [00:00, 290.60it/s]206it [00:00, 292.15it/s]236it [00:00, 293.02it/s]266it [00:00, 289.61it/s]296it [00:01, 290.47it/s]326it [00:01, 290.85it/s]356it [00:01, 290.90it/s]386it [00:01, 290.99it/s]416it [00:01, 291.00it/s]446it [00:01, 291.79it/s]476it [00:01, 291.54it/s]506it [00:01, 292.09it/s]536it [00:01, 292.80it/s]566it [00:01, 292.93it/s]596it [00:02, 292.56it/s]626it [00:02, 292.41it/s]656it [00:02, 292.13it/s]686it [00:02, 292.34it/s]716it [00:02, 292.55it/s]720it [00:02, 285.42it/s]
Epoch: 8, Steps: 107 | Train Loss: 0.0201154 Vali Loss: 0.1517510 Test Loss: 0.1018438
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
0it [00:00, ?it/s]10it [00:00, 99.51it/s]21it [00:00, 103.39it/s]32it [00:00, 104.67it/s]43it [00:00, 105.19it/s]54it [00:00, 105.50it/s]65it [00:00, 105.70it/s]76it [00:00, 105.76it/s]87it [00:00, 105.78it/s]98it [00:00, 105.90it/s]	iters: 100, epoch: 9 | loss: 0.0192106
	speed: 0.0701s/iter; left time: 8.0643s
107it [00:01, 100.69it/s]
Epoch: 9 cost time: 1.3727188110351562
0it [00:00, ?it/s]19it [00:00, 187.59it/s]49it [00:00, 253.18it/s]79it [00:00, 270.77it/s]109it [00:00, 280.90it/s]139it [00:00, 286.96it/s]169it [00:00, 290.29it/s]199it [00:00, 292.35it/s]229it [00:00, 292.52it/s]259it [00:00, 293.16it/s]289it [00:01, 293.54it/s]319it [00:01, 293.72it/s]349it [00:01, 294.42it/s]379it [00:01, 295.26it/s]409it [00:01, 296.06it/s]439it [00:01, 296.44it/s]469it [00:01, 296.97it/s]499it [00:01, 297.27it/s]529it [00:01, 297.11it/s]559it [00:01, 297.11it/s]589it [00:02, 297.55it/s]619it [00:02, 297.43it/s]649it [00:02, 297.05it/s]679it [00:02, 297.05it/s]709it [00:02, 297.51it/s]720it [00:02, 286.42it/s]
0it [00:00, ?it/s]25it [00:00, 247.84it/s]55it [00:00, 275.03it/s]85it [00:00, 283.77it/s]115it [00:00, 289.24it/s]145it [00:00, 292.15it/s]175it [00:00, 293.99it/s]205it [00:00, 295.07it/s]235it [00:00, 296.04it/s]265it [00:00, 296.45it/s]295it [00:01, 296.85it/s]325it [00:01, 296.76it/s]355it [00:01, 297.07it/s]385it [00:01, 297.60it/s]415it [00:01, 297.99it/s]445it [00:01, 298.10it/s]475it [00:01, 298.21it/s]505it [00:01, 298.16it/s]535it [00:01, 298.23it/s]565it [00:01, 297.80it/s]595it [00:02, 297.79it/s]625it [00:02, 298.25it/s]655it [00:02, 298.31it/s]685it [00:02, 298.01it/s]715it [00:02, 297.84it/s]720it [00:02, 289.87it/s]
Epoch: 9, Steps: 107 | Train Loss: 0.0198058 Vali Loss: 0.1504859 Test Loss: 0.1012355
Validation loss decreased (0.150657 --> 0.150486).  Saving model ...
Updating learning rate to 3.90625e-06
0it [00:00, ?it/s]11it [00:00, 105.45it/s]22it [00:00, 106.05it/s]33it [00:00, 106.42it/s]44it [00:00, 106.78it/s]55it [00:00, 106.89it/s]66it [00:00, 106.21it/s]77it [00:00, 106.02it/s]88it [00:00, 106.16it/s]99it [00:00, 106.38it/s]	iters: 100, epoch: 10 | loss: 0.0214396
	speed: 0.0723s/iter; left time: 0.5781s
107it [00:01, 101.33it/s]
Epoch: 10 cost time: 1.3647949695587158
0it [00:00, ?it/s]22it [00:00, 214.09it/s]52it [00:00, 260.48it/s]82it [00:00, 275.12it/s]112it [00:00, 282.85it/s]142it [00:00, 287.41it/s]172it [00:00, 288.81it/s]202it [00:00, 290.65it/s]232it [00:00, 291.93it/s]262it [00:00, 292.44it/s]292it [00:01, 292.49it/s]322it [00:01, 292.02it/s]352it [00:01, 291.36it/s]382it [00:01, 291.19it/s]412it [00:01, 290.70it/s]442it [00:01, 290.63it/s]472it [00:01, 290.18it/s]502it [00:01, 290.68it/s]532it [00:01, 292.10it/s]562it [00:01, 292.80it/s]592it [00:02, 293.12it/s]622it [00:02, 293.46it/s]652it [00:02, 294.00it/s]682it [00:02, 294.32it/s]712it [00:02, 294.33it/s]720it [00:02, 284.12it/s]
0it [00:00, ?it/s]21it [00:00, 206.38it/s]51it [00:00, 256.15it/s]81it [00:00, 271.61it/s]111it [00:00, 280.26it/s]141it [00:00, 283.73it/s]171it [00:00, 286.82it/s]201it [00:00, 289.72it/s]231it [00:00, 291.55it/s]261it [00:00, 293.05it/s]291it [00:01, 293.60it/s]321it [00:01, 293.66it/s]351it [00:01, 293.62it/s]381it [00:01, 294.05it/s]411it [00:01, 293.84it/s]441it [00:01, 293.78it/s]471it [00:01, 293.80it/s]501it [00:01, 294.04it/s]531it [00:01, 293.76it/s]561it [00:01, 293.55it/s]591it [00:02, 292.70it/s]621it [00:02, 293.05it/s]651it [00:02, 292.53it/s]681it [00:02, 293.18it/s]711it [00:02, 294.50it/s]720it [00:02, 284.66it/s]
Epoch: 10, Steps: 107 | Train Loss: 0.0197394 Vali Loss: 0.1527964 Test Loss: 0.1018330
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ETTm1_mask_0.125_GPT4TS_ETTm1_ftM_sl96_ll0_pl0_dm768_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2024-01-05 15:30:37,593 [37mDEBUG test: flag:test,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
test 11521
0it [00:00, ?it/s]1it [00:00,  9.43it/s]21it [00:00, 109.01it/s]41it [00:00, 137.79it/s]61it [00:00, 153.05it/s]81it [00:00, 163.01it/s]101it [00:00, 164.50it/s]121it [00:00, 169.00it/s]141it [00:00, 172.01it/s]161it [00:01, 145.79it/s]181it [00:01, 153.71it/s]201it [00:01, 161.19it/s]221it [00:01, 165.84it/s]241it [00:01, 169.89it/s]261it [00:01, 172.82it/s]281it [00:01, 175.73it/s]301it [00:01, 175.54it/s]321it [00:01, 176.88it/s]341it [00:02, 176.58it/s]361it [00:02, 177.11it/s]381it [00:02, 178.85it/s]401it [00:02, 173.42it/s]421it [00:02, 174.67it/s]441it [00:02, 174.30it/s]461it [00:02, 176.11it/s]481it [00:02, 175.24it/s]501it [00:03, 176.58it/s]521it [00:03, 176.50it/s]541it [00:03, 177.22it/s]561it [00:03, 177.22it/s]581it [00:03, 177.27it/s]601it [00:03, 178.18it/s]621it [00:03, 177.04it/s]641it [00:03, 177.03it/s]661it [00:03, 178.12it/s]681it [00:04, 177.45it/s]701it [00:04, 154.24it/s]720it [00:04, 166.65it/s]
test shape: (11520, 96, 7) (11520, 96, 7)
mse:0.1023155078291893, mae:0.18368861079216003
Use GPU: cuda:0
>>>>>>>start training : imputation_ETTm1_mask_0.125_GPT4TS_ETTm1_ftM_sl96_ll0_pl0_dm768_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
2024-01-05 15:30:52,857 [37mDEBUG test: flag:train,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
train 1724
2024-01-05 15:30:52,901 [37mDEBUG test: flag:val,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
val 11521
2024-01-05 15:30:52,944 [37mDEBUG test: flag:test,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
test 11521
0it [00:00, ?it/s]10it [00:00, 96.52it/s]21it [00:00, 103.64it/s]32it [00:00, 106.51it/s]43it [00:00, 106.98it/s]54it [00:00, 107.36it/s]65it [00:00, 107.53it/s]76it [00:00, 107.54it/s]87it [00:00, 107.49it/s]98it [00:00, 107.51it/s]	iters: 100, epoch: 1 | loss: 0.0232209
	speed: 0.0124s/iter; left time: 12.0862s
107it [00:01, 101.31it/s]
Epoch: 1 cost time: 1.3664419651031494
0it [00:00, ?it/s]27it [00:00, 264.81it/s]56it [00:00, 279.16it/s]85it [00:00, 283.89it/s]114it [00:00, 285.65it/s]144it [00:00, 287.43it/s]174it [00:00, 289.94it/s]204it [00:00, 291.34it/s]234it [00:00, 290.42it/s]264it [00:00, 290.52it/s]294it [00:01, 289.45it/s]323it [00:01, 288.36it/s]353it [00:01, 289.20it/s]383it [00:01, 289.85it/s]413it [00:01, 289.88it/s]443it [00:01, 290.67it/s]473it [00:01, 291.55it/s]503it [00:01, 291.74it/s]533it [00:01, 291.95it/s]563it [00:01, 288.22it/s]592it [00:02, 288.66it/s]622it [00:02, 289.33it/s]651it [00:02, 289.51it/s]681it [00:02, 289.67it/s]711it [00:02, 290.74it/s]720it [00:02, 282.03it/s]
0it [00:00, ?it/s]27it [00:00, 265.79it/s]56it [00:00, 278.52it/s]86it [00:00, 283.79it/s]115it [00:00, 285.11it/s]144it [00:00, 286.78it/s]173it [00:00, 287.82it/s]202it [00:00, 288.50it/s]231it [00:00, 288.21it/s]261it [00:00, 288.94it/s]290it [00:01, 288.51it/s]319it [00:01, 288.07it/s]349it [00:01, 289.26it/s]378it [00:01, 289.42it/s]408it [00:01, 290.41it/s]438it [00:01, 291.40it/s]468it [00:01, 292.29it/s]498it [00:01, 292.45it/s]528it [00:01, 292.33it/s]558it [00:01, 291.62it/s]588it [00:02, 291.89it/s]618it [00:02, 292.32it/s]648it [00:02, 292.96it/s]678it [00:02, 293.21it/s]708it [00:02, 293.35it/s]720it [00:02, 283.84it/s]
Epoch: 1, Steps: 107 | Train Loss: 0.0326960 Vali Loss: 0.1890495 Test Loss: 0.1247960
Validation loss decreased (inf --> 0.189050).  Saving model ...
Updating learning rate to 0.001
0it [00:00, ?it/s]11it [00:00, 103.92it/s]22it [00:00, 105.79it/s]33it [00:00, 106.01it/s]44it [00:00, 106.40it/s]55it [00:00, 106.37it/s]66it [00:00, 106.35it/s]77it [00:00, 106.43it/s]88it [00:00, 106.44it/s]99it [00:00, 106.47it/s]	iters: 100, epoch: 2 | loss: 0.0249646
	speed: 0.0731s/iter; left time: 63.1911s
107it [00:01, 98.60it/s]
Epoch: 2 cost time: 1.3939361572265625
0it [00:00, ?it/s]27it [00:00, 268.31it/s]56it [00:00, 280.04it/s]86it [00:00, 284.99it/s]116it [00:00, 288.08it/s]146it [00:00, 289.95it/s]176it [00:00, 290.55it/s]206it [00:00, 291.24it/s]236it [00:00, 292.26it/s]266it [00:00, 292.42it/s]296it [00:01, 293.09it/s]326it [00:01, 293.27it/s]356it [00:01, 293.60it/s]386it [00:01, 293.73it/s]416it [00:01, 294.26it/s]446it [00:01, 295.22it/s]476it [00:01, 296.35it/s]506it [00:01, 296.57it/s]536it [00:01, 296.61it/s]566it [00:01, 296.53it/s]596it [00:02, 296.81it/s]626it [00:02, 297.09it/s]656it [00:02, 297.14it/s]686it [00:02, 297.40it/s]716it [00:02, 296.93it/s]720it [00:02, 287.68it/s]
0it [00:00, ?it/s]29it [00:00, 283.70it/s]60it [00:00, 293.54it/s]91it [00:00, 296.78it/s]121it [00:00, 297.69it/s]152it [00:00, 298.98it/s]183it [00:00, 299.50it/s]213it [00:00, 297.57it/s]243it [00:00, 297.39it/s]273it [00:00, 297.59it/s]303it [00:01, 296.16it/s]333it [00:01, 294.77it/s]363it [00:01, 295.43it/s]393it [00:01, 296.15it/s]423it [00:01, 295.92it/s]453it [00:01, 295.75it/s]483it [00:01, 296.04it/s]513it [00:01, 297.04it/s]543it [00:01, 296.77it/s]573it [00:01, 297.05it/s]603it [00:02, 297.29it/s]633it [00:02, 297.11it/s]663it [00:02, 297.04it/s]693it [00:02, 297.00it/s]720it [00:02, 291.03it/s]
Epoch: 2, Steps: 107 | Train Loss: 0.0238566 Vali Loss: 0.1654713 Test Loss: 0.1070046
Validation loss decreased (0.189050 --> 0.165471).  Saving model ...
Updating learning rate to 0.0005
0it [00:00, ?it/s]11it [00:00, 101.85it/s]22it [00:00, 105.29it/s]33it [00:00, 106.51it/s]44it [00:00, 106.80it/s]55it [00:00, 106.96it/s]66it [00:00, 106.95it/s]77it [00:00, 106.99it/s]88it [00:00, 106.99it/s]99it [00:00, 106.98it/s]	iters: 100, epoch: 3 | loss: 0.0165749
	speed: 0.0723s/iter; left time: 54.7286s
107it [00:01, 101.71it/s]
Epoch: 3 cost time: 1.3637874126434326
0it [00:00, ?it/s]28it [00:00, 277.78it/s]59it [00:00, 291.08it/s]89it [00:00, 294.43it/s]119it [00:00, 296.04it/s]149it [00:00, 296.64it/s]179it [00:00, 296.83it/s]209it [00:00, 296.88it/s]239it [00:00, 297.14it/s]269it [00:00, 297.42it/s]299it [00:01, 297.27it/s]329it [00:01, 296.95it/s]359it [00:01, 295.98it/s]389it [00:01, 296.05it/s]419it [00:01, 295.35it/s]449it [00:01, 295.16it/s]479it [00:01, 295.03it/s]509it [00:01, 295.19it/s]539it [00:01, 295.69it/s]569it [00:01, 295.64it/s]599it [00:02, 295.82it/s]629it [00:02, 296.17it/s]659it [00:02, 296.51it/s]689it [00:02, 296.64it/s]719it [00:02, 297.13it/s]720it [00:02, 287.91it/s]
0it [00:00, ?it/s]29it [00:00, 279.52it/s]59it [00:00, 290.68it/s]89it [00:00, 293.38it/s]119it [00:00, 294.24it/s]149it [00:00, 295.67it/s]179it [00:00, 296.27it/s]209it [00:00, 296.60it/s]239it [00:00, 295.90it/s]269it [00:00, 295.01it/s]299it [00:01, 295.85it/s]330it [00:01, 297.57it/s]360it [00:01, 298.10it/s]390it [00:01, 297.55it/s]420it [00:01, 297.71it/s]450it [00:01, 298.06it/s]480it [00:01, 298.38it/s]510it [00:01, 298.46it/s]540it [00:01, 298.65it/s]570it [00:01, 298.87it/s]600it [00:02, 299.14it/s]630it [00:02, 299.32it/s]660it [00:02, 299.09it/s]690it [00:02, 298.99it/s]720it [00:02, 291.32it/s]
Epoch: 3, Steps: 107 | Train Loss: 0.0219020 Vali Loss: 0.1506182 Test Loss: 0.1019536
Validation loss decreased (0.165471 --> 0.150618).  Saving model ...
Updating learning rate to 0.00025
0it [00:00, ?it/s]11it [00:00, 101.61it/s]22it [00:00, 105.21it/s]33it [00:00, 106.06it/s]44it [00:00, 106.49it/s]55it [00:00, 106.67it/s]66it [00:00, 106.85it/s]77it [00:00, 106.84it/s]88it [00:00, 106.94it/s]99it [00:00, 107.11it/s]	iters: 100, epoch: 4 | loss: 0.0193845
	speed: 0.0720s/iter; left time: 46.7711s
107it [00:01, 100.93it/s]
Epoch: 4 cost time: 1.3697855472564697
0it [00:00, ?it/s]29it [00:00, 286.30it/s]60it [00:00, 296.53it/s]91it [00:00, 298.87it/s]122it [00:00, 299.91it/s]153it [00:00, 300.69it/s]184it [00:00, 301.91it/s]215it [00:00, 302.13it/s]246it [00:00, 302.12it/s]277it [00:00, 301.69it/s]308it [00:01, 301.27it/s]339it [00:01, 300.51it/s]370it [00:01, 300.37it/s]401it [00:01, 300.00it/s]432it [00:01, 300.46it/s]463it [00:01, 300.05it/s]494it [00:01, 300.59it/s]525it [00:01, 299.86it/s]556it [00:01, 300.09it/s]587it [00:01, 299.75it/s]617it [00:02, 299.71it/s]648it [00:02, 300.04it/s]679it [00:02, 300.42it/s]710it [00:02, 300.76it/s]720it [00:02, 292.74it/s]
0it [00:00, ?it/s]29it [00:00, 282.12it/s]59it [00:00, 291.98it/s]90it [00:00, 295.88it/s]121it [00:00, 297.63it/s]151it [00:00, 298.40it/s]181it [00:00, 298.49it/s]212it [00:00, 299.06it/s]243it [00:00, 299.55it/s]274it [00:00, 300.14it/s]305it [00:01, 300.56it/s]336it [00:01, 296.27it/s]366it [00:01, 296.81it/s]396it [00:01, 297.66it/s]426it [00:01, 297.88it/s]457it [00:01, 298.55it/s]488it [00:01, 299.66it/s]519it [00:01, 300.72it/s]550it [00:01, 301.60it/s]581it [00:01, 302.39it/s]612it [00:02, 301.82it/s]643it [00:02, 302.07it/s]674it [00:02, 302.02it/s]705it [00:02, 302.08it/s]720it [00:02, 292.30it/s]
Epoch: 4, Steps: 107 | Train Loss: 0.0204658 Vali Loss: 0.1535181 Test Loss: 0.1047963
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
0it [00:00, ?it/s]10it [00:00, 98.42it/s]21it [00:00, 103.65it/s]32it [00:00, 105.16it/s]43it [00:00, 105.92it/s]54it [00:00, 106.25it/s]65it [00:00, 106.43it/s]76it [00:00, 106.40it/s]87it [00:00, 106.41it/s]98it [00:00, 106.51it/s]	iters: 100, epoch: 5 | loss: 0.0214172
	speed: 0.0692s/iter; left time: 37.5898s
107it [00:01, 98.75it/s]
Epoch: 5 cost time: 1.393202781677246
0it [00:00, ?it/s]27it [00:00, 263.30it/s]55it [00:00, 271.82it/s]85it [00:00, 281.16it/s]115it [00:00, 285.57it/s]145it [00:00, 289.53it/s]175it [00:00, 291.33it/s]205it [00:00, 292.76it/s]235it [00:00, 294.04it/s]265it [00:00, 294.47it/s]295it [00:01, 295.09it/s]325it [00:01, 295.36it/s]355it [00:01, 295.59it/s]385it [00:01, 294.69it/s]415it [00:01, 294.50it/s]445it [00:01, 294.38it/s]475it [00:01, 293.84it/s]505it [00:01, 293.82it/s]535it [00:01, 294.34it/s]565it [00:01, 294.62it/s]595it [00:02, 295.03it/s]625it [00:02, 295.28it/s]655it [00:02, 295.85it/s]685it [00:02, 295.75it/s]715it [00:02, 296.22it/s]720it [00:02, 287.31it/s]
0it [00:00, ?it/s]28it [00:00, 271.94it/s]58it [00:00, 286.37it/s]88it [00:00, 291.55it/s]118it [00:00, 293.14it/s]148it [00:00, 289.70it/s]178it [00:00, 290.10it/s]208it [00:00, 290.12it/s]238it [00:00, 291.13it/s]268it [00:00, 291.53it/s]298it [00:01, 293.01it/s]328it [00:01, 293.43it/s]358it [00:01, 293.52it/s]388it [00:01, 293.86it/s]418it [00:01, 293.52it/s]448it [00:01, 293.62it/s]478it [00:01, 293.41it/s]508it [00:01, 293.46it/s]538it [00:01, 293.72it/s]568it [00:01, 294.12it/s]598it [00:02, 294.15it/s]628it [00:02, 294.20it/s]658it [00:02, 294.84it/s]688it [00:02, 295.57it/s]718it [00:02, 296.56it/s]720it [00:02, 287.33it/s]
Epoch: 5, Steps: 107 | Train Loss: 0.0196372 Vali Loss: 0.1482389 Test Loss: 0.0986212
Validation loss decreased (0.150618 --> 0.148239).  Saving model ...
Updating learning rate to 6.25e-05
0it [00:00, ?it/s]11it [00:00, 104.56it/s]22it [00:00, 105.92it/s]33it [00:00, 106.53it/s]44it [00:00, 106.74it/s]55it [00:00, 106.89it/s]66it [00:00, 106.95it/s]77it [00:00, 106.95it/s]88it [00:00, 106.95it/s]99it [00:00, 107.00it/s]	iters: 100, epoch: 6 | loss: 0.0181981
	speed: 0.0727s/iter; left time: 31.7079s
107it [00:01, 101.69it/s]
Epoch: 6 cost time: 1.362687349319458
0it [00:00, ?it/s]28it [00:00, 271.79it/s]57it [00:00, 280.91it/s]87it [00:00, 287.88it/s]117it [00:00, 290.92it/s]147it [00:00, 291.93it/s]177it [00:00, 293.47it/s]207it [00:00, 293.60it/s]237it [00:00, 294.29it/s]267it [00:00, 295.55it/s]297it [00:01, 296.09it/s]327it [00:01, 296.34it/s]357it [00:01, 295.94it/s]387it [00:01, 296.02it/s]417it [00:01, 295.89it/s]447it [00:01, 295.65it/s]477it [00:01, 295.85it/s]507it [00:01, 295.98it/s]537it [00:01, 296.19it/s]567it [00:01, 295.93it/s]597it [00:02, 296.01it/s]627it [00:02, 296.06it/s]657it [00:02, 296.98it/s]687it [00:02, 297.35it/s]717it [00:02, 298.13it/s]720it [00:02, 289.08it/s]
0it [00:00, ?it/s]29it [00:00, 284.37it/s]59it [00:00, 292.40it/s]89it [00:00, 294.61it/s]119it [00:00, 296.38it/s]149it [00:00, 297.22it/s]179it [00:00, 297.10it/s]209it [00:00, 297.33it/s]240it [00:00, 298.49it/s]271it [00:00, 298.96it/s]301it [00:01, 299.12it/s]332it [00:01, 299.52it/s]362it [00:01, 299.57it/s]393it [00:01, 299.79it/s]423it [00:01, 299.60it/s]453it [00:01, 299.47it/s]484it [00:01, 300.17it/s]515it [00:01, 300.76it/s]546it [00:01, 300.84it/s]577it [00:01, 300.85it/s]608it [00:02, 300.96it/s]639it [00:02, 300.28it/s]670it [00:02, 300.63it/s]701it [00:02, 300.41it/s]720it [00:02, 293.23it/s]
Epoch: 6, Steps: 107 | Train Loss: 0.0194659 Vali Loss: 0.1491570 Test Loss: 0.0994976
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
0it [00:00, ?it/s]11it [00:00, 105.70it/s]22it [00:00, 105.90it/s]33it [00:00, 106.56it/s]44it [00:00, 106.69it/s]55it [00:00, 106.78it/s]66it [00:00, 106.84it/s]77it [00:00, 106.82it/s]88it [00:00, 106.82it/s]99it [00:00, 106.81it/s]	iters: 100, epoch: 7 | loss: 0.0220152
	speed: 0.0693s/iter; left time: 22.8092s
107it [00:01, 101.48it/s]
Epoch: 7 cost time: 1.3652679920196533
0it [00:00, ?it/s]27it [00:00, 267.29it/s]57it [00:00, 283.25it/s]87it [00:00, 288.24it/s]117it [00:00, 291.55it/s]147it [00:00, 293.80it/s]177it [00:00, 295.86it/s]207it [00:00, 297.09it/s]237it [00:00, 297.01it/s]267it [00:00, 296.63it/s]297it [00:01, 296.82it/s]327it [00:01, 296.52it/s]357it [00:01, 296.30it/s]387it [00:01, 296.17it/s]417it [00:01, 296.37it/s]447it [00:01, 296.39it/s]477it [00:01, 295.89it/s]507it [00:01, 296.52it/s]537it [00:01, 297.52it/s]568it [00:01, 298.33it/s]598it [00:02, 298.68it/s]628it [00:02, 298.30it/s]658it [00:02, 298.54it/s]689it [00:02, 298.98it/s]719it [00:02, 298.16it/s]720it [00:02, 287.93it/s]
0it [00:00, ?it/s]29it [00:00, 281.30it/s]59it [00:00, 287.32it/s]89it [00:00, 290.49it/s]119it [00:00, 292.15it/s]149it [00:00, 292.31it/s]179it [00:00, 292.58it/s]209it [00:00, 292.87it/s]239it [00:00, 292.90it/s]269it [00:00, 293.13it/s]299it [00:01, 293.42it/s]329it [00:01, 294.18it/s]359it [00:01, 294.67it/s]389it [00:01, 294.86it/s]419it [00:01, 295.73it/s]449it [00:01, 296.36it/s]479it [00:01, 296.92it/s]509it [00:01, 296.75it/s]539it [00:01, 296.14it/s]569it [00:01, 295.75it/s]599it [00:02, 295.69it/s]629it [00:02, 296.49it/s]659it [00:02, 296.92it/s]689it [00:02, 297.26it/s]720it [00:02, 298.43it/s]720it [00:02, 289.15it/s]
Epoch: 7, Steps: 107 | Train Loss: 0.0193131 Vali Loss: 0.1469316 Test Loss: 0.0985085
Validation loss decreased (0.148239 --> 0.146932).  Saving model ...
Updating learning rate to 1.5625e-05
0it [00:00, ?it/s]10it [00:00, 98.74it/s]21it [00:00, 103.90it/s]32it [00:00, 105.44it/s]43it [00:00, 106.21it/s]54it [00:00, 106.47it/s]65it [00:00, 106.69it/s]76it [00:00, 106.77it/s]87it [00:00, 106.56it/s]98it [00:00, 106.72it/s]	iters: 100, epoch: 8 | loss: 0.0171202
	speed: 0.0724s/iter; left time: 16.0665s
107it [00:01, 98.75it/s]
Epoch: 8 cost time: 1.3926386833190918
0it [00:00, ?it/s]29it [00:00, 282.61it/s]59it [00:00, 287.27it/s]89it [00:00, 289.65it/s]119it [00:00, 293.24it/s]150it [00:00, 295.78it/s]181it [00:00, 297.73it/s]211it [00:00, 296.64it/s]241it [00:00, 296.70it/s]271it [00:00, 295.84it/s]301it [00:01, 295.70it/s]331it [00:01, 295.14it/s]361it [00:01, 294.87it/s]391it [00:01, 295.23it/s]421it [00:01, 296.05it/s]451it [00:01, 295.62it/s]481it [00:01, 295.04it/s]511it [00:01, 294.90it/s]541it [00:01, 295.17it/s]571it [00:01, 295.61it/s]601it [00:02, 294.91it/s]631it [00:02, 295.24it/s]661it [00:02, 295.33it/s]691it [00:02, 296.20it/s]720it [00:02, 288.85it/s]
0it [00:00, ?it/s]28it [00:00, 275.59it/s]58it [00:00, 289.33it/s]88it [00:00, 294.07it/s]118it [00:00, 295.83it/s]148it [00:00, 296.21it/s]178it [00:00, 297.20it/s]208it [00:00, 297.76it/s]238it [00:00, 297.26it/s]268it [00:00, 297.12it/s]298it [00:01, 297.13it/s]328it [00:01, 297.47it/s]358it [00:01, 297.77it/s]388it [00:01, 298.12it/s]419it [00:01, 298.81it/s]449it [00:01, 298.58it/s]479it [00:01, 298.84it/s]509it [00:01, 299.13it/s]539it [00:01, 298.79it/s]569it [00:01, 298.55it/s]599it [00:02, 298.02it/s]629it [00:02, 298.22it/s]659it [00:02, 298.45it/s]690it [00:02, 299.24it/s]720it [00:02, 291.57it/s]
Epoch: 8, Steps: 107 | Train Loss: 0.0191862 Vali Loss: 0.1472218 Test Loss: 0.1004231
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
0it [00:00, ?it/s]11it [00:00, 105.63it/s]22it [00:00, 106.47it/s]33it [00:00, 106.72it/s]44it [00:00, 106.88it/s]55it [00:00, 106.88it/s]66it [00:00, 106.94it/s]77it [00:00, 106.92it/s]88it [00:00, 106.94it/s]99it [00:00, 107.02it/s]	iters: 100, epoch: 9 | loss: 0.0189227
	speed: 0.0697s/iter; left time: 8.0167s
107it [00:01, 99.99it/s]
Epoch: 9 cost time: 1.3791303634643555
0it [00:00, ?it/s]27it [00:00, 263.44it/s]56it [00:00, 273.99it/s]85it [00:00, 277.37it/s]114it [00:00, 280.04it/s]144it [00:00, 284.02it/s]174it [00:00, 286.28it/s]204it [00:00, 288.48it/s]233it [00:00, 288.94it/s]263it [00:00, 289.70it/s]293it [00:01, 291.30it/s]323it [00:01, 292.75it/s]353it [00:01, 293.09it/s]383it [00:01, 293.70it/s]413it [00:01, 294.65it/s]443it [00:01, 295.13it/s]473it [00:01, 295.13it/s]503it [00:01, 294.51it/s]533it [00:01, 294.61it/s]563it [00:01, 294.19it/s]593it [00:02, 293.93it/s]623it [00:02, 294.91it/s]653it [00:02, 295.42it/s]683it [00:02, 295.62it/s]713it [00:02, 296.37it/s]720it [00:02, 284.41it/s]
0it [00:00, ?it/s]27it [00:00, 267.32it/s]57it [00:00, 284.54it/s]87it [00:00, 289.98it/s]117it [00:00, 293.84it/s]147it [00:00, 295.99it/s]177it [00:00, 296.48it/s]207it [00:00, 296.40it/s]237it [00:00, 296.51it/s]267it [00:00, 297.56it/s]297it [00:01, 298.17it/s]327it [00:01, 297.92it/s]357it [00:01, 297.53it/s]387it [00:01, 297.76it/s]417it [00:01, 297.64it/s]447it [00:01, 297.37it/s]477it [00:01, 297.48it/s]508it [00:01, 298.69it/s]539it [00:01, 299.23it/s]570it [00:01, 299.47it/s]600it [00:02, 299.35it/s]631it [00:02, 299.44it/s]661it [00:02, 299.41it/s]692it [00:02, 299.71it/s]720it [00:02, 288.91it/s]
Epoch: 9, Steps: 107 | Train Loss: 0.0191440 Vali Loss: 0.1484672 Test Loss: 0.1002625
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
0it [00:00, ?it/s]11it [00:00, 107.85it/s]22it [00:00, 107.83it/s]33it [00:00, 107.30it/s]44it [00:00, 107.25it/s]55it [00:00, 107.35it/s]66it [00:00, 107.48it/s]77it [00:00, 107.44it/s]88it [00:00, 107.48it/s]99it [00:00, 107.41it/s]	iters: 100, epoch: 10 | loss: 0.0173558
	speed: 0.0703s/iter; left time: 0.5623s
107it [00:01, 102.52it/s]
Epoch: 10 cost time: 1.352675437927246
0it [00:00, ?it/s]28it [00:00, 273.95it/s]58it [00:00, 287.71it/s]88it [00:00, 292.14it/s]118it [00:00, 293.89it/s]148it [00:00, 295.03it/s]178it [00:00, 295.95it/s]208it [00:00, 295.71it/s]238it [00:00, 296.04it/s]268it [00:00, 296.31it/s]298it [00:01, 295.35it/s]328it [00:01, 295.72it/s]358it [00:01, 296.37it/s]388it [00:01, 296.97it/s]418it [00:01, 296.62it/s]448it [00:01, 296.37it/s]478it [00:01, 295.82it/s]508it [00:01, 295.69it/s]538it [00:01, 295.52it/s]568it [00:01, 295.73it/s]598it [00:02, 296.29it/s]628it [00:02, 296.30it/s]658it [00:02, 296.46it/s]688it [00:02, 296.36it/s]718it [00:02, 295.84it/s]720it [00:02, 286.75it/s]
0it [00:00, ?it/s]28it [00:00, 277.57it/s]58it [00:00, 285.67it/s]88it [00:00, 289.08it/s]117it [00:00, 289.23it/s]147it [00:00, 289.63it/s]176it [00:00, 289.58it/s]206it [00:00, 289.93it/s]235it [00:00, 289.82it/s]264it [00:00, 289.85it/s]294it [00:01, 291.78it/s]324it [00:01, 293.36it/s]354it [00:01, 295.27it/s]384it [00:01, 296.46it/s]414it [00:01, 297.12it/s]444it [00:01, 297.28it/s]474it [00:01, 297.52it/s]505it [00:01, 298.98it/s]536it [00:01, 299.43it/s]567it [00:01, 299.66it/s]597it [00:02, 299.67it/s]628it [00:02, 300.12it/s]659it [00:02, 300.08it/s]690it [00:02, 300.37it/s]720it [00:02, 289.38it/s]
Epoch: 10, Steps: 107 | Train Loss: 0.0192725 Vali Loss: 0.1473973 Test Loss: 0.1010696
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : imputation_ETTm1_mask_0.125_GPT4TS_ETTm1_ftM_sl96_ll0_pl0_dm768_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2024-01-05 15:32:04,185 [37mDEBUG test: flag:test,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
test 11521
0it [00:00, ?it/s]6it [00:00, 59.52it/s]24it [00:00, 127.92it/s]41it [00:00, 139.77it/s]61it [00:00, 154.32it/s]81it [00:00, 164.09it/s]101it [00:00, 167.13it/s]121it [00:00, 170.48it/s]141it [00:00, 172.90it/s]161it [00:00, 175.29it/s]181it [00:01, 175.86it/s]201it [00:01, 176.87it/s]221it [00:01, 177.59it/s]241it [00:01, 179.45it/s]261it [00:01, 178.71it/s]281it [00:01, 178.95it/s]301it [00:01, 177.13it/s]321it [00:01, 177.62it/s]341it [00:02, 177.19it/s]361it [00:02, 177.38it/s]381it [00:02, 178.97it/s]401it [00:02, 178.01it/s]421it [00:02, 178.30it/s]441it [00:02, 176.84it/s]461it [00:02, 177.46it/s]481it [00:02, 175.79it/s]501it [00:02, 176.46it/s]521it [00:03, 175.95it/s]541it [00:03, 177.03it/s]561it [00:03, 177.47it/s]581it [00:03, 141.74it/s]601it [00:03, 150.77it/s]621it [00:03, 157.23it/s]641it [00:03, 162.28it/s]661it [00:03, 166.93it/s]681it [00:04, 169.37it/s]701it [00:04, 172.25it/s]720it [00:04, 169.72it/s]
test shape: (11520, 96, 7) (11520, 96, 7)
mse:0.09853310883045197, mae:0.1823786348104477
Use GPU: cuda:0
>>>>>>>start training : imputation_ETTm1_mask_0.125_GPT4TS_ETTm1_ftM_sl96_ll0_pl0_dm768_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
2024-01-05 15:32:19,368 [37mDEBUG test: flag:train,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
train 1724
2024-01-05 15:32:19,411 [37mDEBUG test: flag:val,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
val 11521
2024-01-05 15:32:19,453 [37mDEBUG test: flag:test,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
test 11521
0it [00:00, ?it/s]11it [00:00, 101.49it/s]22it [00:00, 104.79it/s]33it [00:00, 106.06it/s]44it [00:00, 106.72it/s]55it [00:00, 107.12it/s]66it [00:00, 106.97it/s]77it [00:00, 106.95it/s]88it [00:00, 107.04it/s]99it [00:00, 105.84it/s]	iters: 100, epoch: 1 | loss: 0.0256449
	speed: 0.0126s/iter; left time: 12.2163s
107it [00:01, 100.02it/s]
Epoch: 1 cost time: 1.3890972137451172
0it [00:00, ?it/s]27it [00:00, 269.08it/s]55it [00:00, 273.47it/s]84it [00:00, 279.72it/s]113it [00:00, 283.63it/s]143it [00:00, 286.52it/s]173it [00:00, 289.01it/s]203it [00:00, 290.56it/s]233it [00:00, 291.36it/s]263it [00:00, 292.34it/s]293it [00:01, 292.90it/s]323it [00:01, 293.46it/s]353it [00:01, 292.79it/s]383it [00:01, 292.59it/s]413it [00:01, 293.30it/s]443it [00:01, 293.49it/s]473it [00:01, 293.57it/s]503it [00:01, 293.89it/s]533it [00:01, 293.78it/s]563it [00:01, 293.35it/s]593it [00:02, 293.65it/s]623it [00:02, 293.79it/s]653it [00:02, 294.53it/s]683it [00:02, 294.26it/s]713it [00:02, 294.95it/s]720it [00:02, 285.82it/s]
0it [00:00, ?it/s]25it [00:00, 243.56it/s]53it [00:00, 262.44it/s]82it [00:00, 273.64it/s]111it [00:00, 278.34it/s]140it [00:00, 281.69it/s]169it [00:00, 284.05it/s]199it [00:00, 286.80it/s]229it [00:00, 288.89it/s]259it [00:00, 290.28it/s]289it [00:01, 290.92it/s]319it [00:01, 290.91it/s]349it [00:01, 291.20it/s]379it [00:01, 291.74it/s]409it [00:01, 292.50it/s]439it [00:01, 292.42it/s]469it [00:01, 292.70it/s]499it [00:01, 293.14it/s]529it [00:01, 293.37it/s]559it [00:01, 293.55it/s]589it [00:02, 293.65it/s]619it [00:02, 293.72it/s]649it [00:02, 293.86it/s]679it [00:02, 294.12it/s]709it [00:02, 294.31it/s]720it [00:02, 283.25it/s]
Epoch: 1, Steps: 107 | Train Loss: 0.0368379 Vali Loss: 0.2101494 Test Loss: 0.1408016
Validation loss decreased (inf --> 0.210149).  Saving model ...
Updating learning rate to 0.001
0it [00:00, ?it/s]11it [00:00, 103.79it/s]22it [00:00, 105.53it/s]33it [00:00, 106.41it/s]44it [00:00, 106.62it/s]55it [00:00, 106.79it/s]66it [00:00, 106.77it/s]77it [00:00, 106.76it/s]88it [00:00, 106.64it/s]99it [00:00, 106.71it/s]	iters: 100, epoch: 2 | loss: 0.0257486
	speed: 0.0727s/iter; left time: 62.8297s
107it [00:01, 101.28it/s]
Epoch: 2 cost time: 1.375218391418457
0it [00:00, ?it/s]29it [00:00, 282.54it/s]59it [00:00, 287.29it/s]89it [00:00, 289.70it/s]119it [00:00, 291.22it/s]149it [00:00, 291.63it/s]179it [00:00, 291.58it/s]209it [00:00, 292.00it/s]239it [00:00, 291.77it/s]269it [00:00, 291.56it/s]299it [00:01, 292.20it/s]329it [00:01, 292.44it/s]359it [00:01, 293.51it/s]389it [00:01, 293.40it/s]419it [00:01, 293.51it/s]449it [00:01, 293.39it/s]479it [00:01, 293.70it/s]509it [00:01, 294.18it/s]539it [00:01, 294.06it/s]569it [00:01, 294.22it/s]599it [00:02, 293.73it/s]629it [00:02, 294.64it/s]659it [00:02, 295.74it/s]689it [00:02, 296.43it/s]719it [00:02, 296.92it/s]720it [00:02, 286.50it/s]
0it [00:00, ?it/s]28it [00:00, 278.26it/s]58it [00:00, 287.67it/s]88it [00:00, 291.20it/s]118it [00:00, 291.86it/s]148it [00:00, 291.37it/s]178it [00:00, 291.20it/s]208it [00:00, 290.77it/s]238it [00:00, 288.12it/s]268it [00:00, 289.13it/s]298it [00:01, 289.84it/s]328it [00:01, 291.31it/s]358it [00:01, 292.46it/s]388it [00:01, 293.16it/s]418it [00:01, 294.32it/s]448it [00:01, 294.94it/s]478it [00:01, 294.85it/s]508it [00:01, 295.08it/s]538it [00:01, 294.48it/s]568it [00:01, 295.22it/s]598it [00:02, 295.65it/s]628it [00:02, 296.36it/s]658it [00:02, 295.83it/s]688it [00:02, 296.34it/s]718it [00:02, 295.95it/s]720it [00:02, 287.16it/s]
Epoch: 2, Steps: 107 | Train Loss: 0.0246250 Vali Loss: 0.1698409 Test Loss: 0.1136239
Validation loss decreased (0.210149 --> 0.169841).  Saving model ...
Updating learning rate to 0.0005
0it [00:00, ?it/s]11it [00:00, 101.25it/s]22it [00:00, 104.70it/s]33it [00:00, 105.74it/s]44it [00:00, 106.02it/s]55it [00:00, 106.24it/s]66it [00:00, 106.43it/s]77it [00:00, 106.43it/s]88it [00:00, 106.47it/s]99it [00:00, 106.61it/s]	iters: 100, epoch: 3 | loss: 0.0206542
	speed: 0.0729s/iter; left time: 55.1522s
107it [00:01, 100.62it/s]
Epoch: 3 cost time: 1.3813042640686035
0it [00:00, ?it/s]28it [00:00, 272.43it/s]58it [00:00, 285.07it/s]88it [00:00, 288.88it/s]118it [00:00, 290.74it/s]148it [00:00, 290.14it/s]178it [00:00, 289.87it/s]208it [00:00, 290.49it/s]238it [00:00, 291.04it/s]268it [00:00, 291.59it/s]298it [00:01, 291.53it/s]328it [00:01, 291.45it/s]358it [00:01, 291.48it/s]388it [00:01, 291.50it/s]418it [00:01, 291.51it/s]448it [00:01, 292.46it/s]478it [00:01, 292.75it/s]508it [00:01, 293.23it/s]538it [00:01, 293.52it/s]568it [00:01, 293.79it/s]598it [00:02, 294.02it/s]628it [00:02, 293.90it/s]658it [00:02, 294.08it/s]688it [00:02, 294.04it/s]718it [00:02, 294.95it/s]720it [00:02, 285.68it/s]
0it [00:00, ?it/s]28it [00:00, 276.31it/s]57it [00:00, 283.40it/s]87it [00:00, 287.80it/s]117it [00:00, 289.58it/s]147it [00:00, 290.65it/s]177it [00:00, 292.62it/s]207it [00:00, 293.32it/s]237it [00:00, 292.92it/s]267it [00:00, 292.69it/s]297it [00:01, 293.51it/s]327it [00:01, 294.96it/s]357it [00:01, 295.30it/s]387it [00:01, 295.85it/s]417it [00:01, 296.27it/s]447it [00:01, 296.54it/s]477it [00:01, 296.77it/s]507it [00:01, 297.05it/s]537it [00:01, 296.46it/s]567it [00:01, 295.77it/s]597it [00:02, 295.49it/s]627it [00:02, 295.11it/s]657it [00:02, 295.31it/s]687it [00:02, 295.09it/s]717it [00:02, 296.08it/s]720it [00:02, 288.21it/s]
Epoch: 3, Steps: 107 | Train Loss: 0.0230952 Vali Loss: 0.1649076 Test Loss: 0.1092939
Validation loss decreased (0.169841 --> 0.164908).  Saving model ...
Updating learning rate to 0.00025
0it [00:00, ?it/s]11it [00:00, 103.93it/s]22it [00:00, 105.58it/s]33it [00:00, 106.09it/s]44it [00:00, 106.36it/s]55it [00:00, 106.41it/s]66it [00:00, 106.50it/s]77it [00:00, 106.65it/s]88it [00:00, 106.61it/s]99it [00:00, 106.67it/s]	iters: 100, epoch: 4 | loss: 0.0167354
	speed: 0.0727s/iter; left time: 47.2868s
107it [00:01, 101.00it/s]
Epoch: 4 cost time: 1.3803796768188477
0it [00:00, ?it/s]28it [00:00, 279.85it/s]58it [00:00, 286.27it/s]87it [00:00, 287.56it/s]116it [00:00, 287.90it/s]145it [00:00, 286.92it/s]175it [00:00, 288.01it/s]204it [00:00, 288.23it/s]233it [00:00, 288.13it/s]263it [00:00, 289.31it/s]293it [00:01, 290.03it/s]323it [00:01, 290.38it/s]353it [00:01, 289.83it/s]383it [00:01, 289.93it/s]412it [00:01, 288.89it/s]441it [00:01, 288.91it/s]471it [00:01, 289.32it/s]500it [00:01, 289.02it/s]530it [00:01, 289.63it/s]560it [00:01, 290.09it/s]590it [00:02, 290.29it/s]620it [00:02, 290.75it/s]650it [00:02, 291.11it/s]680it [00:02, 291.55it/s]710it [00:02, 292.09it/s]720it [00:02, 282.83it/s]
0it [00:00, ?it/s]25it [00:00, 247.04it/s]54it [00:00, 269.32it/s]83it [00:00, 278.56it/s]112it [00:00, 282.87it/s]141it [00:00, 284.91it/s]171it [00:00, 286.84it/s]201it [00:00, 288.50it/s]231it [00:00, 290.06it/s]261it [00:00, 290.95it/s]291it [00:01, 291.99it/s]321it [00:01, 292.82it/s]351it [00:01, 293.11it/s]381it [00:01, 293.36it/s]411it [00:01, 293.01it/s]441it [00:01, 292.89it/s]471it [00:01, 293.52it/s]501it [00:01, 294.36it/s]531it [00:01, 295.33it/s]561it [00:01, 295.68it/s]591it [00:02, 295.12it/s]621it [00:02, 294.94it/s]651it [00:02, 293.70it/s]681it [00:02, 293.46it/s]711it [00:02, 293.21it/s]720it [00:02, 284.88it/s]
Epoch: 4, Steps: 107 | Train Loss: 0.0218321 Vali Loss: 0.1600404 Test Loss: 0.1083353
Validation loss decreased (0.164908 --> 0.160040).  Saving model ...
Updating learning rate to 0.000125
0it [00:00, ?it/s]11it [00:00, 103.92it/s]22it [00:00, 106.26it/s]33it [00:00, 106.69it/s]44it [00:00, 106.91it/s]55it [00:00, 107.03it/s]66it [00:00, 107.20it/s]77it [00:00, 107.14it/s]88it [00:00, 107.15it/s]99it [00:00, 107.08it/s]	iters: 100, epoch: 5 | loss: 0.0182378
	speed: 0.0733s/iter; left time: 39.8203s
107it [00:01, 101.66it/s]
Epoch: 5 cost time: 1.3721799850463867
0it [00:00, ?it/s]29it [00:00, 278.47it/s]59it [00:00, 288.01it/s]89it [00:00, 290.86it/s]119it [00:00, 292.17it/s]149it [00:00, 292.91it/s]179it [00:00, 293.58it/s]209it [00:00, 293.37it/s]239it [00:00, 294.34it/s]269it [00:00, 294.63it/s]299it [00:01, 295.04it/s]329it [00:01, 294.69it/s]359it [00:01, 294.97it/s]389it [00:01, 295.55it/s]419it [00:01, 296.05it/s]449it [00:01, 295.75it/s]479it [00:01, 296.10it/s]509it [00:01, 295.97it/s]539it [00:01, 296.82it/s]569it [00:01, 297.34it/s]599it [00:02, 297.89it/s]629it [00:02, 297.72it/s]659it [00:02, 297.44it/s]689it [00:02, 297.13it/s]719it [00:02, 296.73it/s]720it [00:02, 285.87it/s]
0it [00:00, ?it/s]28it [00:00, 277.21it/s]58it [00:00, 286.35it/s]88it [00:00, 290.75it/s]118it [00:00, 292.05it/s]148it [00:00, 292.67it/s]178it [00:00, 293.04it/s]208it [00:00, 294.00it/s]238it [00:00, 294.49it/s]268it [00:00, 294.64it/s]298it [00:01, 295.47it/s]328it [00:01, 295.68it/s]358it [00:01, 295.09it/s]388it [00:01, 295.56it/s]418it [00:01, 296.33it/s]448it [00:01, 296.44it/s]478it [00:01, 296.39it/s]508it [00:01, 296.67it/s]538it [00:01, 296.59it/s]568it [00:01, 296.67it/s]598it [00:02, 296.83it/s]628it [00:02, 296.80it/s]658it [00:02, 296.92it/s]688it [00:02, 296.33it/s]718it [00:02, 297.22it/s]720it [00:02, 289.02it/s]
Epoch: 5, Steps: 107 | Train Loss: 0.0211908 Vali Loss: 0.1560087 Test Loss: 0.1055534
Validation loss decreased (0.160040 --> 0.156009).  Saving model ...
Updating learning rate to 6.25e-05
0it [00:00, ?it/s]11it [00:00, 106.69it/s]22it [00:00, 106.49it/s]33it [00:00, 106.51it/s]44it [00:00, 106.69it/s]55it [00:00, 106.58it/s]66it [00:00, 106.66it/s]77it [00:00, 106.77it/s]88it [00:00, 106.75it/s]99it [00:00, 106.69it/s]	iters: 100, epoch: 6 | loss: 0.0195797
	speed: 0.0726s/iter; left time: 31.6648s
107it [00:01, 101.40it/s]
Epoch: 6 cost time: 1.3769316673278809
0it [00:00, ?it/s]28it [00:00, 272.44it/s]58it [00:00, 285.17it/s]88it [00:00, 287.30it/s]117it [00:00, 287.04it/s]147it [00:00, 288.75it/s]177it [00:00, 290.21it/s]207it [00:00, 290.96it/s]237it [00:00, 291.18it/s]267it [00:00, 291.67it/s]297it [00:01, 291.76it/s]327it [00:01, 292.36it/s]357it [00:01, 292.91it/s]387it [00:01, 293.37it/s]417it [00:01, 293.67it/s]447it [00:01, 293.84it/s]477it [00:01, 294.08it/s]507it [00:01, 294.25it/s]537it [00:01, 294.62it/s]567it [00:01, 294.01it/s]597it [00:02, 293.30it/s]627it [00:02, 293.41it/s]657it [00:02, 293.08it/s]687it [00:02, 292.83it/s]717it [00:02, 292.76it/s]720it [00:02, 285.74it/s]
0it [00:00, ?it/s]28it [00:00, 276.67it/s]57it [00:00, 284.41it/s]87it [00:00, 287.10it/s]117it [00:00, 288.78it/s]147it [00:00, 290.08it/s]177it [00:00, 292.11it/s]207it [00:00, 293.07it/s]237it [00:00, 292.93it/s]267it [00:00, 292.86it/s]297it [00:01, 292.99it/s]327it [00:01, 293.44it/s]357it [00:01, 293.71it/s]387it [00:01, 294.04it/s]417it [00:01, 293.90it/s]447it [00:01, 294.30it/s]477it [00:01, 294.65it/s]507it [00:01, 295.04it/s]537it [00:01, 295.44it/s]567it [00:01, 296.40it/s]597it [00:02, 297.03it/s]627it [00:02, 296.81it/s]657it [00:02, 297.10it/s]687it [00:02, 297.62it/s]717it [00:02, 298.02it/s]720it [00:02, 286.76it/s]
Epoch: 6, Steps: 107 | Train Loss: 0.0210334 Vali Loss: 0.1553139 Test Loss: 0.1048981
Validation loss decreased (0.156009 --> 0.155314).  Saving model ...
Updating learning rate to 3.125e-05
0it [00:00, ?it/s]9it [00:00, 88.76it/s]20it [00:00, 99.85it/s]31it [00:00, 103.34it/s]42it [00:00, 104.70it/s]53it [00:00, 105.50it/s]64it [00:00, 106.06it/s]75it [00:00, 106.29it/s]86it [00:00, 106.73it/s]97it [00:00, 106.82it/s]	iters: 100, epoch: 7 | loss: 0.0200474
	speed: 0.0730s/iter; left time: 24.0054s
107it [00:01, 100.25it/s]
Epoch: 7 cost time: 1.388293981552124
0it [00:00, ?it/s]29it [00:00, 282.25it/s]59it [00:00, 288.97it/s]89it [00:00, 291.34it/s]119it [00:00, 292.19it/s]149it [00:00, 292.92it/s]179it [00:00, 293.64it/s]209it [00:00, 294.17it/s]239it [00:00, 294.20it/s]269it [00:00, 293.92it/s]299it [00:01, 294.24it/s]329it [00:01, 294.35it/s]359it [00:01, 293.94it/s]389it [00:01, 293.61it/s]419it [00:01, 294.23it/s]449it [00:01, 294.92it/s]479it [00:01, 295.29it/s]509it [00:01, 295.24it/s]539it [00:01, 295.95it/s]569it [00:01, 296.14it/s]599it [00:02, 296.53it/s]629it [00:02, 296.79it/s]659it [00:02, 296.58it/s]689it [00:02, 296.24it/s]719it [00:02, 296.10it/s]720it [00:02, 288.57it/s]
0it [00:00, ?it/s]28it [00:00, 279.90it/s]58it [00:00, 288.77it/s]88it [00:00, 292.95it/s]118it [00:00, 294.62it/s]148it [00:00, 295.29it/s]178it [00:00, 294.98it/s]208it [00:00, 295.49it/s]238it [00:00, 295.72it/s]268it [00:00, 295.78it/s]298it [00:01, 295.75it/s]328it [00:01, 295.93it/s]358it [00:01, 296.19it/s]388it [00:01, 296.22it/s]418it [00:01, 295.91it/s]448it [00:01, 296.01it/s]478it [00:01, 296.16it/s]508it [00:01, 296.17it/s]538it [00:01, 295.60it/s]568it [00:01, 295.66it/s]598it [00:02, 295.82it/s]628it [00:02, 296.42it/s]658it [00:02, 296.77it/s]688it [00:02, 297.07it/s]718it [00:02, 297.27it/s]720it [00:02, 289.45it/s]
Epoch: 7, Steps: 107 | Train Loss: 0.0205374 Vali Loss: 0.1538709 Test Loss: 0.1043602
Validation loss decreased (0.155314 --> 0.153871).  Saving model ...
Updating learning rate to 1.5625e-05
0it [00:00, ?it/s]11it [00:00, 104.42it/s]22it [00:00, 106.40it/s]33it [00:00, 106.78it/s]44it [00:00, 106.82it/s]55it [00:00, 106.90it/s]66it [00:00, 106.86it/s]77it [00:00, 106.99it/s]88it [00:00, 106.99it/s]99it [00:00, 106.96it/s]	iters: 100, epoch: 8 | loss: 0.0194244
	speed: 0.0724s/iter; left time: 16.0784s
107it [00:01, 101.72it/s]
Epoch: 8 cost time: 1.373417615890503
0it [00:00, ?it/s]27it [00:00, 268.00it/s]56it [00:00, 280.39it/s]85it [00:00, 282.49it/s]114it [00:00, 284.14it/s]143it [00:00, 283.91it/s]172it [00:00, 285.54it/s]201it [00:00, 286.00it/s]230it [00:00, 287.22it/s]259it [00:00, 287.92it/s]288it [00:01, 288.11it/s]318it [00:01, 288.74it/s]348it [00:01, 289.99it/s]378it [00:01, 289.99it/s]407it [00:01, 289.75it/s]437it [00:01, 290.50it/s]467it [00:01, 291.74it/s]497it [00:01, 292.39it/s]527it [00:01, 292.93it/s]557it [00:01, 293.19it/s]587it [00:02, 293.37it/s]617it [00:02, 293.75it/s]647it [00:02, 293.63it/s]677it [00:02, 293.77it/s]707it [00:02, 293.94it/s]720it [00:02, 280.61it/s]
0it [00:00, ?it/s]27it [00:00, 267.94it/s]56it [00:00, 280.42it/s]85it [00:00, 284.18it/s]115it [00:00, 288.53it/s]145it [00:00, 291.06it/s]175it [00:00, 293.08it/s]205it [00:00, 294.20it/s]235it [00:00, 294.61it/s]265it [00:00, 295.03it/s]295it [00:01, 295.44it/s]325it [00:01, 295.99it/s]355it [00:01, 295.86it/s]385it [00:01, 295.66it/s]415it [00:01, 295.75it/s]445it [00:01, 295.96it/s]475it [00:01, 296.09it/s]505it [00:01, 296.53it/s]535it [00:01, 297.08it/s]565it [00:01, 297.38it/s]595it [00:02, 297.98it/s]625it [00:02, 298.57it/s]655it [00:02, 298.56it/s]685it [00:02, 297.81it/s]715it [00:02, 298.46it/s]720it [00:02, 288.52it/s]
Epoch: 8, Steps: 107 | Train Loss: 0.0209489 Vali Loss: 0.1531170 Test Loss: 0.1037929
Validation loss decreased (0.153871 --> 0.153117).  Saving model ...
Updating learning rate to 7.8125e-06
0it [00:00, ?it/s]11it [00:00, 103.78it/s]22it [00:00, 105.52it/s]33it [00:00, 106.07it/s]44it [00:00, 106.21it/s]55it [00:00, 106.35it/s]66it [00:00, 106.35it/s]77it [00:00, 106.41it/s]88it [00:00, 106.50it/s]99it [00:00, 106.55it/s]	iters: 100, epoch: 9 | loss: 0.0201746
	speed: 0.0731s/iter; left time: 8.4112s
107it [00:01, 101.00it/s]
Epoch: 9 cost time: 1.380979061126709
0it [00:00, ?it/s]29it [00:00, 281.81it/s]59it [00:00, 287.04it/s]89it [00:00, 290.95it/s]119it [00:00, 293.08it/s]149it [00:00, 293.95it/s]179it [00:00, 294.36it/s]209it [00:00, 294.88it/s]239it [00:00, 295.44it/s]269it [00:00, 295.28it/s]299it [00:01, 295.26it/s]329it [00:01, 295.52it/s]359it [00:01, 295.60it/s]389it [00:01, 295.62it/s]419it [00:01, 295.91it/s]449it [00:01, 295.88it/s]479it [00:01, 295.94it/s]509it [00:01, 296.27it/s]539it [00:01, 296.23it/s]569it [00:01, 296.60it/s]599it [00:02, 296.91it/s]629it [00:02, 297.26it/s]659it [00:02, 297.21it/s]689it [00:02, 297.49it/s]719it [00:02, 297.90it/s]720it [00:02, 288.65it/s]
0it [00:00, ?it/s]28it [00:00, 271.18it/s]58it [00:00, 283.63it/s]88it [00:00, 288.09it/s]117it [00:00, 288.57it/s]147it [00:00, 290.18it/s]177it [00:00, 290.96it/s]207it [00:00, 291.38it/s]237it [00:00, 291.52it/s]267it [00:00, 291.84it/s]297it [00:01, 291.00it/s]327it [00:01, 291.74it/s]357it [00:01, 292.33it/s]387it [00:01, 293.13it/s]417it [00:01, 293.81it/s]447it [00:01, 294.15it/s]477it [00:01, 294.36it/s]507it [00:01, 294.64it/s]537it [00:01, 294.91it/s]567it [00:01, 294.75it/s]597it [00:02, 294.41it/s]627it [00:02, 293.72it/s]657it [00:02, 293.88it/s]687it [00:02, 294.07it/s]717it [00:02, 294.78it/s]720it [00:02, 285.69it/s]
Epoch: 9, Steps: 107 | Train Loss: 0.0206203 Vali Loss: 0.1530038 Test Loss: 0.1031445
Validation loss decreased (0.153117 --> 0.153004).  Saving model ...
Updating learning rate to 3.90625e-06
0it [00:00, ?it/s]11it [00:00, 103.75it/s]22it [00:00, 106.08it/s]33it [00:00, 106.59it/s]44it [00:00, 106.93it/s]55it [00:00, 107.13it/s]66it [00:00, 107.28it/s]77it [00:00, 107.20it/s]88it [00:00, 107.26it/s]99it [00:00, 107.23it/s]	iters: 100, epoch: 10 | loss: 0.0162159
	speed: 0.0727s/iter; left time: 0.5816s
107it [00:01, 101.47it/s]
Epoch: 10 cost time: 1.3735077381134033
0it [00:00, ?it/s]27it [00:00, 264.37it/s]56it [00:00, 279.11it/s]86it [00:00, 284.56it/s]116it [00:00, 287.35it/s]146it [00:00, 289.44it/s]176it [00:00, 290.48it/s]206it [00:00, 291.05it/s]236it [00:00, 291.93it/s]266it [00:00, 291.99it/s]296it [00:01, 292.73it/s]326it [00:01, 293.03it/s]356it [00:01, 293.46it/s]386it [00:01, 293.26it/s]416it [00:01, 293.37it/s]446it [00:01, 293.43it/s]476it [00:01, 294.41it/s]506it [00:01, 294.34it/s]536it [00:01, 295.30it/s]566it [00:01, 296.25it/s]596it [00:02, 296.83it/s]626it [00:02, 297.30it/s]656it [00:02, 297.50it/s]686it [00:02, 297.55it/s]716it [00:02, 298.21it/s]720it [00:02, 285.65it/s]
0it [00:00, ?it/s]27it [00:00, 265.27it/s]56it [00:00, 278.57it/s]86it [00:00, 285.07it/s]116it [00:00, 288.26it/s]146it [00:00, 290.04it/s]176it [00:00, 291.49it/s]206it [00:00, 291.88it/s]236it [00:00, 292.62it/s]266it [00:00, 293.18it/s]296it [00:01, 293.39it/s]326it [00:01, 293.51it/s]356it [00:01, 293.60it/s]386it [00:01, 293.44it/s]416it [00:01, 292.84it/s]446it [00:01, 293.41it/s]476it [00:01, 293.73it/s]506it [00:01, 294.12it/s]536it [00:01, 294.02it/s]566it [00:01, 294.10it/s]596it [00:02, 294.09it/s]626it [00:02, 294.33it/s]656it [00:02, 294.58it/s]686it [00:02, 294.83it/s]716it [00:02, 294.99it/s]720it [00:02, 286.37it/s]
Epoch: 10, Steps: 107 | Train Loss: 0.0205158 Vali Loss: 0.1527970 Test Loss: 0.1028557
Validation loss decreased (0.153004 --> 0.152797).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : imputation_ETTm1_mask_0.125_GPT4TS_ETTm1_ftM_sl96_ll0_pl0_dm768_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2024-01-05 15:33:32,448 [37mDEBUG test: flag:test,root_path:/root/data/NeurIPS2023-One-Fits-All/Imputation/dataset/ETT-small/,data_path:ETTm1.csv,size:[96, 0, 0],features:M,target:OT,timeenc:1,percent:5,freq:h,seasonal_patterns:Monthly[0m
test 11521
0it [00:00, ?it/s]4it [00:00, 39.98it/s]22it [00:00, 120.70it/s]41it [00:00, 144.33it/s]61it [00:00, 158.71it/s]81it [00:00, 167.66it/s]101it [00:00, 170.67it/s]121it [00:00, 174.06it/s]141it [00:00, 175.35it/s]161it [00:00, 176.57it/s]181it [00:01, 175.61it/s]201it [00:01, 176.21it/s]221it [00:01, 175.80it/s]241it [00:01, 176.68it/s]261it [00:01, 176.23it/s]281it [00:01, 176.65it/s]301it [00:01, 175.97it/s]321it [00:01, 175.89it/s]341it [00:02, 175.20it/s]361it [00:02, 175.24it/s]381it [00:02, 176.65it/s]401it [00:02, 176.02it/s]421it [00:02, 176.04it/s]441it [00:02, 175.07it/s]461it [00:02, 176.20it/s]481it [00:02, 174.39it/s]501it [00:02, 175.14it/s]521it [00:03, 175.26it/s]541it [00:03, 176.26it/s]561it [00:03, 132.36it/s]581it [00:03, 140.04it/s]601it [00:03, 148.92it/s]621it [00:03, 155.62it/s]641it [00:03, 161.63it/s]661it [00:03, 166.88it/s]681it [00:04, 169.71it/s]701it [00:04, 173.73it/s]720it [00:04, 167.47it/s]
test shape: (11520, 96, 7) (11520, 96, 7)
mse:0.10148357599973679, mae:0.18567097187042236
